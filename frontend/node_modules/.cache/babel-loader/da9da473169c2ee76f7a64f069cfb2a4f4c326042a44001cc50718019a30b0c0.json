{"ast":null,"code":"import _objectSpread from\"C:/Users/RC_Student_lab/Desktop/goon/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';// Cache configuration\nconst CACHE_DURATION=5*60*1000;// 5 minutes\nconst RATE_LIMIT={windowMs:60*1000,// 1 minute\nmaxRequests:30// 30 requests per minute\n};// Request tracking\nconst requestTimestamps=[];// Helper function to handle API responses\nconst handleResponse=async response=>{if(!response.ok){const error=await response.json();throw new Error(error.message||'API request failed');}return response.json();};// Helper function to create fetch options with auth header\nconst createFetchOptions=function(){let options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const token=localStorage.getItem('token');return _objectSpread(_objectSpread({},options),{},{headers:_objectSpread(_objectSpread({'Content-Type':'application/json'},token?{Authorization:\"Bearer \".concat(token)}:{}),options.headers),credentials:'include'});};// Rate limiting helper\nconst checkRateLimit=()=>{const now=Date.now();const windowStart=now-RATE_LIMIT.windowMs;// Remove old timestamps\nwhile(requestTimestamps.length&&requestTimestamps[0]<windowStart){requestTimestamps.shift();}// Check if we're over the limit\nif(requestTimestamps.length>=RATE_LIMIT.maxRequests){throw new Error('Rate limit exceeded. Please try again later.');}// Add current timestamp\nrequestTimestamps.push(now);};// Cache implementation\nconst cache=new Map();const getCachedData=key=>{const cached=cache.get(key);if(cached&&Date.now()-cached.timestamp<CACHE_DURATION){return cached.data;}return null;};const setCachedData=(key,data)=>{cache.set(key,{data,timestamp:Date.now()});};// Helper function to make API requests with caching and rate limiting\nconst makeRequest=async function(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};let useCache=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const cacheKey=\"\".concat(endpoint,\"-\").concat(JSON.stringify(options));// Check cache first\nif(useCache){const cachedData=getCachedData(cacheKey);if(cachedData){return cachedData;}}// Check rate limit\ncheckRateLimit();try{const response=await fetch(\"\".concat(API_URL).concat(endpoint),_objectSpread(_objectSpread({},createFetchOptions(options)),{},{signal:AbortSignal.timeout(10000)// 10 second timeout\n}));const data=await handleResponse(response);// Cache successful responses\nif(useCache){setCachedData(cacheKey,data);}return data;}catch(error){if(error.name==='AbortError'){throw new Error('Request timed out');}throw error;}};// Auth API calls\nexport const auth={login:async(username,password)=>{return makeRequest('/auth/login',{method:'POST',body:JSON.stringify({username,password})},false);},register:async(username,password)=>{return makeRequest('/auth/register',{method:'POST',body:JSON.stringify({username,password})},false);}};// Protected API calls\nconst getAuthHeader=()=>{const token=localStorage.getItem('token');return token?{Authorization:\"Bearer \".concat(token)}:{};};export const protectedApi={getProfile:async()=>{const response=await fetch(\"\".concat(API_URL,\"/users/profile\"),{headers:_objectSpread({},getAuthHeader())});return handleResponse(response);}};// Sessions API\nexport const sessions={create:async sessionData=>{return makeRequest('/sessions',{method:'POST',body:JSON.stringify(sessionData)},false);// Don't cache POST requests\n},getAll:async()=>{return makeRequest('/sessions');},getStats:async()=>{return makeRequest('/sessions/stats');},getLeaderboard:async function(){let timeframe=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'weekly';return makeRequest(\"/sessions/leaderboard?timeframe=\".concat(timeframe));}};","map":{"version":3,"names":["API_URL","process","env","REACT_APP_API_URL","CACHE_DURATION","RATE_LIMIT","windowMs","maxRequests","requestTimestamps","handleResponse","response","ok","error","json","Error","message","createFetchOptions","options","arguments","length","undefined","token","localStorage","getItem","_objectSpread","headers","Authorization","concat","credentials","checkRateLimit","now","Date","windowStart","shift","push","cache","Map","getCachedData","key","cached","get","timestamp","data","setCachedData","set","makeRequest","endpoint","useCache","cacheKey","JSON","stringify","cachedData","fetch","signal","AbortSignal","timeout","name","auth","login","username","password","method","body","register","getAuthHeader","protectedApi","getProfile","sessions","create","sessionData","getAll","getStats","getLeaderboard","timeframe"],"sources":["C:/Users/RC_Student_lab/Desktop/goon/frontend/src/services/api.js"],"sourcesContent":["const API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\n// Cache configuration\r\nconst CACHE_DURATION = 5 * 60 * 1000; // 5 minutes\r\nconst RATE_LIMIT = {\r\n  windowMs: 60 * 1000, // 1 minute\r\n  maxRequests: 30 // 30 requests per minute\r\n};\r\n\r\n// Request tracking\r\nconst requestTimestamps = [];\r\n\r\n// Helper function to handle API responses\r\nconst handleResponse = async (response) => {\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.message || 'API request failed');\r\n  }\r\n  return response.json();\r\n};\r\n\r\n// Helper function to create fetch options with auth header\r\nconst createFetchOptions = (options = {}) => {\r\n  const token = localStorage.getItem('token');\r\n  return {\r\n    ...options,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n      ...options.headers,\r\n    },\r\n    credentials: 'include',\r\n  };\r\n};\r\n\r\n// Rate limiting helper\r\nconst checkRateLimit = () => {\r\n  const now = Date.now();\r\n  const windowStart = now - RATE_LIMIT.windowMs;\r\n  \r\n  // Remove old timestamps\r\n  while (requestTimestamps.length && requestTimestamps[0] < windowStart) {\r\n    requestTimestamps.shift();\r\n  }\r\n  \r\n  // Check if we're over the limit\r\n  if (requestTimestamps.length >= RATE_LIMIT.maxRequests) {\r\n    throw new Error('Rate limit exceeded. Please try again later.');\r\n  }\r\n  \r\n  // Add current timestamp\r\n  requestTimestamps.push(now);\r\n};\r\n\r\n// Cache implementation\r\nconst cache = new Map();\r\n\r\nconst getCachedData = (key) => {\r\n  const cached = cache.get(key);\r\n  if (cached && Date.now() - cached.timestamp < CACHE_DURATION) {\r\n    return cached.data;\r\n  }\r\n  return null;\r\n};\r\n\r\nconst setCachedData = (key, data) => {\r\n  cache.set(key, {\r\n    data,\r\n    timestamp: Date.now()\r\n  });\r\n};\r\n\r\n// Helper function to make API requests with caching and rate limiting\r\nconst makeRequest = async (endpoint, options = {}, useCache = true) => {\r\n  const cacheKey = `${endpoint}-${JSON.stringify(options)}`;\r\n  \r\n  // Check cache first\r\n  if (useCache) {\r\n    const cachedData = getCachedData(cacheKey);\r\n    if (cachedData) {\r\n      return cachedData;\r\n    }\r\n  }\r\n  \r\n  // Check rate limit\r\n  checkRateLimit();\r\n  \r\n  try {\r\n    const response = await fetch(`${API_URL}${endpoint}`, {\r\n      ...createFetchOptions(options),\r\n      signal: AbortSignal.timeout(10000) // 10 second timeout\r\n    });\r\n    \r\n    const data = await handleResponse(response);\r\n    \r\n    // Cache successful responses\r\n    if (useCache) {\r\n      setCachedData(cacheKey, data);\r\n    }\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    if (error.name === 'AbortError') {\r\n      throw new Error('Request timed out');\r\n    }\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Auth API calls\r\nexport const auth = {\r\n  login: async (username, password) => {\r\n    return makeRequest('/auth/login', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ username, password })\r\n    }, false);\r\n  },\r\n\r\n  register: async (username, password) => {\r\n    return makeRequest('/auth/register', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ username, password })\r\n    }, false);\r\n  },\r\n};\r\n\r\n// Protected API calls\r\nconst getAuthHeader = () => {\r\n  const token = localStorage.getItem('token');\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n};\r\n\r\nexport const protectedApi = {\r\n  getProfile: async () => {\r\n    const response = await fetch(`${API_URL}/users/profile`, {\r\n      headers: {\r\n        ...getAuthHeader(),\r\n      },\r\n    });\r\n    return handleResponse(response);\r\n  },\r\n};\r\n\r\n// Sessions API\r\nexport const sessions = {\r\n  create: async (sessionData) => {\r\n    return makeRequest('/sessions', {\r\n      method: 'POST',\r\n      body: JSON.stringify(sessionData)\r\n    }, false); // Don't cache POST requests\r\n  },\r\n\r\n  getAll: async () => {\r\n    return makeRequest('/sessions');\r\n  },\r\n\r\n  getStats: async () => {\r\n    return makeRequest('/sessions/stats');\r\n  },\r\n\r\n  getLeaderboard: async (timeframe = 'weekly') => {\r\n    return makeRequest(`/sessions/leaderboard?timeframe=${timeframe}`);\r\n  },\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}